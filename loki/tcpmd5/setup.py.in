#!/usr/bin/env python

import glob, os, sys
from distutils.core import setup, Extension

tcpmd5_srcs = [ '@srcdir@/tcpmd5.c' ]
tcpmd5_incdirs = []
tcpmd5_libdirs = []
tcpmd5_libs = []
tcpmd5_extargs = []
tcpmd5_extobj = []

tcpmd5bf_srcs = [ '@srcdir@/tcpmd5bf.c', '@top_srcdir@/lib/md5.c' ]
tcpmd5bf_incdirs = [ '@top_srcdir@' ]
tcpmd5bf_libdirs = []
tcpmd5bf_libs = []
tcpmd5bf_extargs = []
tcpmd5bf_extobj = []


if sys.platform == 'win32':
    #~ winpcap_dir = '../../WPdpack'
    #~ dnet_srcs.extend(['../src/addr-util.c', '../src/addr.c', '../src/blob.c', '../src/ip-util.c', '../src/ip6.c', '../src/rand.c', '../src/err.c', '../src/strlcat.c', '../src/strlcpy.c', '../src/err.c', '../src/strlcat.c', '../src/strlcpy.c', '../src/strsep.c', '../src/arp-win32.c', '../src/eth-win32.c', '../src/fw-pktfilter.c', '../src/intf-win32.c', '../src/ip-win32.c', '../src/route-win32.c', '../src/tun-none.c'])
    #~ dnet_incdirs.append(winpcap_dir + '/Include')
    #~ dnet_libdirs.append(winpcap_dir + '/Lib')
    #~ dnet_libs.extend([ 'advapi32', 'iphlpapi', 'ws2_32', 'packet' ])
    pass
else:
    # XXX - can't build on Cygwin+MinGW yet.
    #if sys.platform == 'cygwin':
    #    dnet_extargs.append('-mno-cygwin')
    pass

tcpmd5 = Extension( 'tcpmd5',
                    tcpmd5_srcs,
                    include_dirs=tcpmd5_incdirs,
                    library_dirs=tcpmd5_libdirs,
                    libraries=tcpmd5_libs,
                    extra_compile_args=tcpmd5_extargs,
                    extra_objects=tcpmd5_extobj)

tcpmd5bf = Extension(   'tcpmd5bf',
                        tcpmd5bf_srcs,
                        include_dirs=tcpmd5bf_incdirs,
                        library_dirs=tcpmd5bf_libdirs,
                        libraries=tcpmd5bf_libs,
                        extra_compile_args=tcpmd5bf_extargs,
                        extra_objects=tcpmd5bf_extobj)

setup(name='tcpmd5',
      version='@VERSION@',
      description='',
      author='Daniel Mende',
      author_email='dmende@ernw.de',
      url='https://c0decafe.de',
      ext_modules = [ tcpmd5 ])

setup(name='tcpmd5bf',
      version='@VERSION@',
      description='',
      author='Daniel Mende',
      author_email='dmende@ernw.de',
      url='https://c0decafe.de',
      ext_modules = [ tcpmd5bf ])
